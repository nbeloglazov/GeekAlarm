# Server

Server application for GeekAlarm.

## Usage

Server handles following GET requests:

* **/categories** - returns array in json of categories:

```javascript
[{"name": "Linear algebra", "code": "linear-algebra"},
 {"name": "Mathematical analysis", "code": "math-analysis"}]
```

* **/task** - generates and returns task. Parameters:
   *category* - code of one of categories
   *level* - 1, 2 or 3
   Example: /task?category=linear-algebra&level=1
   Result json contains id of task and number of correct answer (1 to 4):

```javascript
{"id": "01234567", "correct": 2}
```

* **/image** - returns image (for question or one of answers) for given task. Parameters:
   *id* - task id
   *type* - "question" or "choice"
   *number* - number of choice if type is "choice"
   Example: /image?id=01234567&type=choice&number=1

* **/result** - tell server result for particular task
   *id* - task id
   *solved* - result, true of false
   Example: /result?id=01234567&solved=true

## Architecture

Internally server works in following way:
1. receives request to generate task.
2. generates id and task. Task is generated by **task-manager**.
3. adds task to map of active tasks. After predefined timeout (e.g. 10 min) task will be removed from map.
4. return json with task's id and correct answer.
5. receives request for image for this task.
6. finds task in map and returns appropriate image.

### task-manager
task-manager contains information of all task categories. For every category it contains vector of generators - functions which generates some specific kind of task (e.g. determinant, inverse matrix). Generator takes only level and returns map with following keys: ```:question```, ```:choices```, ```:correct```.
```:question``` - either InputStream of image or MathML expression (in cljml form). MathML expression will be rendered to image InputStream.
```:choices```  - collection of InputStream's of images or MathML expressions.
```:correct``` - number of correct answer

## License

Copyright (C) 2011 Nikita Beloglazov
